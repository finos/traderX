/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * To learn more about Gradle by exploring our Samples at https://docs.gradle.org/8.8/samples
 */

// Apply the java plugin to add support for Java
plugins {
  id 'scala'
  id "com.github.node-gradle.node" version "7.1.0"
}

node {
  npmInstallCommand = System.getenv("CI") ? 'ci' : 'install'

  // Enabled the automatic download.
  download = true
}

repositories {
  mavenCentral()
}

// In this section you declare the dependencies for your production and test code
dependencies {
  implementation 'org.morphir:morphir-sdk-core_2.13:0.21.0'
  implementation 'org.morphir:morphir-sdk-json_2.13:0.21.0'
  implementation 'org.scala-lang:scala-library:2.13.15'
  implementation 'io.circe:circe-core_2.13:0.14.10'
}

tasks.register('generateMorphirIR', NpxTask) {
  dependsOn 'npmInstall'
  command = "morphir-elm"
  args = ["make", "-f"]
}

tasks.register('morphirScalaGen', NpxTask) {
  dependsOn 'generateMorphirIR'
  command = "morphir-elm"
  args = ['gen', '-t', 'scala', '-s', '-o', './src/main/scala']
}

compileScala.dependsOn morphirScalaGen
